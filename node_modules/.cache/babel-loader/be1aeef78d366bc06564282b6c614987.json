{"ast":null,"code":"import { getUiOptions, resolveSchema } from \"./\";\nexport function getPreviewLocalizedString(localizedString, props) {\n  var formContext = props.formContext;\n  var currentLocale = formContext && formContext.currentLocale || formContext && formContext.languages && formContext.languages[0];\n\n  if (!currentLocale) {\n    return;\n  }\n\n  var localeId = \"locale:\" + currentLocale;\n  return localizedString && localizedString[localeId];\n}\nexport function getPreviewFilters(value, props) {\n  var schema = props.schema,\n      formData = props.formData,\n      index = props.index;\n\n  if (schema && schema.type === \"array\" && formData && formData.length) {\n    value = value && value.replace(\"{count}\", formData.length);\n  } else if (index) {\n    value = value && value.replace(\"{count}\", index + 1);\n    value = value && value.replace(\"{index}\", index);\n  }\n\n  return value;\n}\nexport function getPreviewData(preview, props) {\n  var schema = props.schema,\n      formData = props.formData;\n  var select = preview.select,\n      prepare = preview.prepare,\n      single = preview.single,\n      plural = preview.plural,\n      empty = preview.empty;\n  var selection;\n\n  if (prepare && typeof prepare === \"function\") {\n    selection = prepare(props);\n  } else if (prepare) {\n    selection = prepare;\n  } else {\n    selection = formData;\n  }\n\n  var data = {};\n\n  if (select) {\n    Object.keys(select).map(function (name) {\n      var key = select[name] || name;\n      var value = null;\n\n      if (select.hasOwnProperty(key) && selection && selection[key]) {\n        value = selection[key];\n      }\n\n      if (typeof value === \"object\" && value !== null && schema && schema.type === \"array\") {\n        if (formData && formData.length && formData.length > 1 && value.plural) {\n          value = value.plural;\n        } else if (formData && formData.length && formData.length === 1 && value.single) {\n          value = value.single;\n        } else if (value.empty) {\n          value = value.empty;\n        }\n      }\n      /*\n       if (typeof value === \"object\" && value !== null) {\n          value = getPreviewLocalizedString(value, props)\n      }\n       */\n\n\n      if (value && typeof value === \"string\") {\n        value = getPreviewFilters(value, props);\n      }\n\n      if (name === \"metadata\" && selection[key]) {\n        data[name] = selection[key];\n      }\n\n      if (value) {\n        data[name] = value;\n      }\n    });\n  }\n\n  return data;\n}\nexport var getUiPreview = function getUiPreview(_ref) {\n  var schema = _ref.schema,\n      _ref$uiSchema = _ref.uiSchema,\n      uiSchema = _ref$uiSchema === void 0 ? {} : _ref$uiSchema,\n      formData = _ref.formData,\n      formContext = _ref.formContext,\n      index = _ref.index;\n  var uiOptions = getUiOptions(uiSchema);\n  var previewData = {\n    schema: schema,\n    formData: formData,\n    formContext: formContext,\n    index: index\n  };\n\n  if (uiOptions.preview) {\n    return getPreviewData(uiOptions.preview, previewData);\n  }\n};\nexport default getUiPreview;","map":{"version":3,"sources":["/Users/inge/Sites/kit-kulturpunkt/node_modules/@kit-ui/schema/es/utils/getUiPreview.js"],"names":["getUiOptions","resolveSchema","getPreviewLocalizedString","localizedString","props","formContext","currentLocale","languages","localeId","getPreviewFilters","value","schema","formData","index","type","length","replace","getPreviewData","preview","select","prepare","single","plural","empty","selection","data","Object","keys","map","name","key","hasOwnProperty","getUiPreview","_ref","_ref$uiSchema","uiSchema","uiOptions","previewData"],"mappings":"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","sourcesContent":["import { getUiOptions, resolveSchema } from \"./\";\nexport function getPreviewLocalizedString(localizedString, props) {\n  var formContext = props.formContext;\n  var currentLocale = formContext && formContext.currentLocale || formContext && formContext.languages && formContext.languages[0];\n\n  if (!currentLocale) {\n    return;\n  }\n\n  var localeId = \"locale:\" + currentLocale;\n  return localizedString && localizedString[localeId];\n}\nexport function getPreviewFilters(value, props) {\n  var schema = props.schema,\n      formData = props.formData,\n      index = props.index;\n\n  if (schema && schema.type === \"array\" && formData && formData.length) {\n    value = value && value.replace(\"{count}\", formData.length);\n  } else if (index) {\n    value = value && value.replace(\"{count}\", index + 1);\n    value = value && value.replace(\"{index}\", index);\n  }\n\n  return value;\n}\nexport function getPreviewData(preview, props) {\n  var schema = props.schema,\n      formData = props.formData;\n  var select = preview.select,\n      prepare = preview.prepare,\n      single = preview.single,\n      plural = preview.plural,\n      empty = preview.empty;\n  var selection;\n\n  if (prepare && typeof prepare === \"function\") {\n    selection = prepare(props);\n  } else if (prepare) {\n    selection = prepare;\n  } else {\n    selection = formData;\n  }\n\n  var data = {};\n\n  if (select) {\n    Object.keys(select).map(function (name) {\n      var key = select[name] || name;\n      var value = null;\n\n      if (select.hasOwnProperty(key) && selection && selection[key]) {\n        value = selection[key];\n      }\n\n      if (typeof value === \"object\" && value !== null && schema && schema.type === \"array\") {\n        if (formData && formData.length && formData.length > 1 && value.plural) {\n          value = value.plural;\n        } else if (formData && formData.length && formData.length === 1 && value.single) {\n          value = value.single;\n        } else if (value.empty) {\n          value = value.empty;\n        }\n      }\n      /*\n       if (typeof value === \"object\" && value !== null) {\n          value = getPreviewLocalizedString(value, props)\n      }\n       */\n\n\n      if (value && typeof value === \"string\") {\n        value = getPreviewFilters(value, props);\n      }\n\n      if (name === \"metadata\" && selection[key]) {\n        data[name] = selection[key];\n      }\n\n      if (value) {\n        data[name] = value;\n      }\n    });\n  }\n\n  return data;\n}\nexport var getUiPreview = function getUiPreview(_ref) {\n  var schema = _ref.schema,\n      _ref$uiSchema = _ref.uiSchema,\n      uiSchema = _ref$uiSchema === void 0 ? {} : _ref$uiSchema,\n      formData = _ref.formData,\n      formContext = _ref.formContext,\n      index = _ref.index;\n  var uiOptions = getUiOptions(uiSchema);\n  var previewData = {\n    schema: schema,\n    formData: formData,\n    formContext: formContext,\n    index: index\n  };\n\n  if (uiOptions.preview) {\n    return getPreviewData(uiOptions.preview, previewData);\n  }\n};\nexport default getUiPreview;"]},"metadata":{},"sourceType":"module"}