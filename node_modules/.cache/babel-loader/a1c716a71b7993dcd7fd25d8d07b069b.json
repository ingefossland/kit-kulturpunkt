{"ast":null,"code":"function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nimport React from \"react\";\nimport { getUiOptions, getDefaultFormState, getUiToolbar, getReferenceButtons } from \"../utils\";\n\nvar ReferenceField = function ReferenceField(props) {\n  var schema = props.schema,\n      _props$uiSchema = props.uiSchema,\n      uiSchema = _props$uiSchema === void 0 ? {} : _props$uiSchema,\n      _props$formData = props.formData,\n      formData = _props$formData === void 0 ? {} : _props$formData,\n      formContext = props.formContext;\n  var referenceId = formData.referenceId,\n      _formData$reference = formData.reference,\n      reference = _formData$reference === void 0 ? {} : _formData$reference;\n\n  var getUiSchema = function getUiSchema() {\n    var uiOptions = getUiOptions(uiSchema);\n    var fieldset = uiOptions.fieldset || [];\n\n    if (!uiOptions.fieldset && schema.properties) {\n      Object.keys(schema.properties).map(function (name) {\n        var type = schema.properties[name] && schema.properties[name].type || undefined;\n\n        if (type === \"object\") {\n          fieldset.push(name);\n        }\n\n        if (type === \"array\") {\n          fieldset.push(name);\n        }\n      });\n    }\n\n    var uiReference, uiContent;\n\n    if (fieldset && fieldset.includes('reference')) {\n      var uiSchemaReference = uiSchema && uiSchema.reference;\n      uiReference = _extends({\n        \"ui:title\": \"Reference\"\n      }, uiSchemaReference);\n    }\n\n    if (fieldset && fieldset.includes('content')) {\n      var uiSchemaContent = uiSchema && uiSchema.content;\n      uiContent = _extends({\n        \"ui:title\": \"Innhold\"\n      }, uiSchemaContent);\n    }\n\n    var layout = uiOptions.layout || \"module\";\n    return _extends({\n      \"ui:editable\": true,\n      \"ui:deletable\": referenceId && true,\n      \"ui:restorable\": referenceId && true,\n      \"ui:removable\": !referenceId && true,\n      \"ui:layout\": layout,\n      \"ui:fieldset\": fieldset,\n      \"ui:buttons\": getReferenceButtons(props),\n      \"ui:nav\": \"tabs\",\n      \"reference\": uiReference,\n      \"content\": uiContent,\n      \"ui:preview\": {\n        \"select\": {\n          \"_action\": \"_action\",\n          \"type\": \"type\",\n          \"title\": \"title\",\n          \"description\": \"description\",\n          \"imageUrl\": \"imageUrl\",\n          \"status\": \"status\",\n          \"referenceId\": \"referenceId\",\n          \"reference\": \"reference\"\n        },\n        prepare: function prepare(_ref) {\n          var _ref$formData = _ref.formData,\n              formData = _ref$formData === void 0 ? {} : _ref$formData;\n          var _action = formData._action,\n              reference = formData.reference,\n              referenceId = formData.referenceId;\n          var status = reference && reference.status;\n\n          if (_action === \"delete\") {\n            status = \"trash\";\n          }\n\n          return {\n            _action: _action,\n            type: reference && reference.documentType,\n            title: reference && reference.title,\n            description: reference && reference.description,\n            imageUrl: reference && reference.imageUrl,\n            status: status,\n            referenceId: referenceId,\n            reference: reference\n          };\n        }\n      }\n    }, uiSchema);\n  };\n\n  var _onChange = function _onChange(formData) {\n    var _action = formData._action,\n        referenceId = formData.referenceId,\n        _formData$reference2 = formData.reference,\n        reference = _formData$reference2 === void 0 ? {} : _formData$reference2; // if no referenceId, action = \"create\"\n\n    if (!referenceId) {\n      formData._action = \"create\";\n    } // if reference dont have a uniqueId, action = \"create\"\n\n\n    if (!reference) {\n      formData.reference = {};\n    }\n\n    if (!reference.uniqueId) {\n      formData.reference._action = \"create\";\n    }\n\n    props.onChange && props.onChange(formData);\n  };\n\n  var ObjectField = props.registry.fields.ObjectField;\n  var newUiSchema = getUiSchema();\n  return /*#__PURE__*/React.createElement(ObjectField, _extends({}, props, {\n    uiSchema: newUiSchema,\n    onChange: _onChange\n  }));\n};\n\nexport default ReferenceField;","map":{"version":3,"sources":["/Users/inge/Sites/kit-kulturpunkt/node_modules/@kit-ui/schema/es/Reference/ReferenceField.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","React","getUiOptions","getDefaultFormState","getUiToolbar","getReferenceButtons","ReferenceField","props","schema","_props$uiSchema","uiSchema","_props$formData","formData","formContext","referenceId","_formData$reference","reference","getUiSchema","uiOptions","fieldset","properties","keys","map","name","type","undefined","push","uiReference","uiContent","includes","uiSchemaReference","uiSchemaContent","content","layout","prepare","_ref","_ref$formData","_action","status","documentType","title","description","imageUrl","_onChange","_formData$reference2","uniqueId","onChange","ObjectField","registry","fields","newUiSchema","createElement"],"mappings":"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","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from \"react\";\nimport { getUiOptions, getDefaultFormState, getUiToolbar, getReferenceButtons } from \"../utils\";\n\nvar ReferenceField = function ReferenceField(props) {\n  var schema = props.schema,\n      _props$uiSchema = props.uiSchema,\n      uiSchema = _props$uiSchema === void 0 ? {} : _props$uiSchema,\n      _props$formData = props.formData,\n      formData = _props$formData === void 0 ? {} : _props$formData,\n      formContext = props.formContext;\n  var referenceId = formData.referenceId,\n      _formData$reference = formData.reference,\n      reference = _formData$reference === void 0 ? {} : _formData$reference;\n\n  var getUiSchema = function getUiSchema() {\n    var uiOptions = getUiOptions(uiSchema);\n    var fieldset = uiOptions.fieldset || [];\n\n    if (!uiOptions.fieldset && schema.properties) {\n      Object.keys(schema.properties).map(function (name) {\n        var type = schema.properties[name] && schema.properties[name].type || undefined;\n\n        if (type === \"object\") {\n          fieldset.push(name);\n        }\n\n        if (type === \"array\") {\n          fieldset.push(name);\n        }\n      });\n    }\n\n    var uiReference, uiContent;\n\n    if (fieldset && fieldset.includes('reference')) {\n      var uiSchemaReference = uiSchema && uiSchema.reference;\n      uiReference = _extends({\n        \"ui:title\": \"Reference\"\n      }, uiSchemaReference);\n    }\n\n    if (fieldset && fieldset.includes('content')) {\n      var uiSchemaContent = uiSchema && uiSchema.content;\n      uiContent = _extends({\n        \"ui:title\": \"Innhold\"\n      }, uiSchemaContent);\n    }\n\n    var layout = uiOptions.layout || \"module\";\n    return _extends({\n      \"ui:editable\": true,\n      \"ui:deletable\": referenceId && true,\n      \"ui:restorable\": referenceId && true,\n      \"ui:removable\": !referenceId && true,\n      \"ui:layout\": layout,\n      \"ui:fieldset\": fieldset,\n      \"ui:buttons\": getReferenceButtons(props),\n      \"ui:nav\": \"tabs\",\n      \"reference\": uiReference,\n      \"content\": uiContent,\n      \"ui:preview\": {\n        \"select\": {\n          \"_action\": \"_action\",\n          \"type\": \"type\",\n          \"title\": \"title\",\n          \"description\": \"description\",\n          \"imageUrl\": \"imageUrl\",\n          \"status\": \"status\",\n          \"referenceId\": \"referenceId\",\n          \"reference\": \"reference\"\n        },\n        prepare: function prepare(_ref) {\n          var _ref$formData = _ref.formData,\n              formData = _ref$formData === void 0 ? {} : _ref$formData;\n          var _action = formData._action,\n              reference = formData.reference,\n              referenceId = formData.referenceId;\n          var status = reference && reference.status;\n\n          if (_action === \"delete\") {\n            status = \"trash\";\n          }\n\n          return {\n            _action: _action,\n            type: reference && reference.documentType,\n            title: reference && reference.title,\n            description: reference && reference.description,\n            imageUrl: reference && reference.imageUrl,\n            status: status,\n            referenceId: referenceId,\n            reference: reference\n          };\n        }\n      }\n    }, uiSchema);\n  };\n\n  var _onChange = function _onChange(formData) {\n    var _action = formData._action,\n        referenceId = formData.referenceId,\n        _formData$reference2 = formData.reference,\n        reference = _formData$reference2 === void 0 ? {} : _formData$reference2; // if no referenceId, action = \"create\"\n\n    if (!referenceId) {\n      formData._action = \"create\";\n    } // if reference dont have a uniqueId, action = \"create\"\n\n\n    if (!reference) {\n      formData.reference = {};\n    }\n\n    if (!reference.uniqueId) {\n      formData.reference._action = \"create\";\n    }\n\n    props.onChange && props.onChange(formData);\n  };\n\n  var ObjectField = props.registry.fields.ObjectField;\n  var newUiSchema = getUiSchema();\n  return /*#__PURE__*/React.createElement(ObjectField, _extends({}, props, {\n    uiSchema: newUiSchema,\n    onChange: _onChange\n  }));\n};\n\nexport default ReferenceField;"]},"metadata":{},"sourceType":"module"}