{"ast":null,"code":"var _jsxFileName = \"/Users/inge/Sites/kit-kulturpunkt/src/Admin/Admin.js\";\nimport React, { useEffect, useState } from \"react\";\nimport { AppLayout } from \"@kit-ui/admin\";\nimport { useSelector, useDispatch } from 'react-redux';\nimport { getApp, getAppLayout, toggleSearch, getParents } from '../redux/app';\nimport _ from \"lodash\";\nimport qs from 'query-string';\nimport appData from \"./app\";\nimport AdminRoutes from \"./AdminRoutes\";\n\nconst Admin = props => {\n  const {\n    pathname\n  } = props.location;\n  const sq = props.location.search && qs.parse(props.location.search) || {};\n  const dispatch = useDispatch();\n  useEffect(() => {\n    dispatch(getApp(appData));\n  }, []);\n  const app = useSelector(state => state.app);\n  const menuByUrl = app && app.menuByUrl;\n  useEffect(() => {\n    menuByUrl && dispatch(getParents({\n      menuByUrl,\n      pathname: pathname\n    }));\n  }, [menuByUrl, pathname]); // date + view\n\n  let date = sq.date;\n  let view = sq.view;\n\n  if (!view) {\n    view = \"week\";\n  } // select menu or calendar\n\n\n  const _onSelect = ({\n    url,\n    date\n  }) => {\n    if (!url && date) {\n      sq.date = date;\n      props.history.replace(pathname + \"?\" + qs.stringify(sq));\n    }\n\n    url && props.history.push(url);\n  }; // search\n\n\n  const [q, setQ] = useState(sq && sq.q);\n  useEffect(() => {\n    if (q) {\n      sq.q = q.replace(' ', '+');\n    } else {\n      delete sq.q;\n    }\n\n    let query = qs.stringify(sq);\n    const pathname = props.location.pathname + \"?\" + query;\n    const hash = props.location.hash;\n    const url = hash && pathname + hash || pathname;\n\n    if (props.history) {\n      props.history.replace(url);\n    }\n  }, [q]);\n\n  const _onSearchQuery = _.debounce((q, event) => {\n    setQ(q);\n  }, 500);\n\n  const _onSearchReset = () => {\n    if (q) {\n      setQ('');\n    } else {\n      dispatch(toggleSearch());\n    }\n  }; // search\n\n\n  const search = { ...app.search,\n    //        expanded: q && q.length && true,\n    q: q,\n    onChange: (q, event) => _onSearchQuery(q),\n    onReset: (q, event) => _onSearchReset(),\n    onToggle: () => dispatch(toggleSearch())\n  };\n  return /*#__PURE__*/React.createElement(AppLayout, {\n    app: app,\n    theme: app && app.theme,\n    header: app && app.header,\n    search: search,\n    sidebar: app && app.sidebar,\n    primaryAction: app.primaryAction,\n    menu: app && app.menu,\n    menuByUrl: app && app.menuByUrl,\n    currentUrl: pathname,\n    parents: app && app.parents,\n    onSelect: _onSelect,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(AdminRoutes, Object.assign({}, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 17\n    }\n  })));\n};\n\nexport default Admin;","map":{"version":3,"sources":["/Users/inge/Sites/kit-kulturpunkt/src/Admin/Admin.js"],"names":["React","useEffect","useState","AppLayout","useSelector","useDispatch","getApp","getAppLayout","toggleSearch","getParents","_","qs","appData","AdminRoutes","Admin","props","pathname","location","sq","search","parse","dispatch","app","state","menuByUrl","date","view","_onSelect","url","history","replace","stringify","push","q","setQ","query","hash","_onSearchQuery","debounce","event","_onSearchReset","onChange","onReset","onToggle","theme","header","sidebar","primaryAction","menu","parents"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\"\nimport { AppLayout} from \"@kit-ui/admin\"\nimport { useSelector, useDispatch } from 'react-redux';\nimport { getApp, getAppLayout, toggleSearch, getParents } from '../redux/app';\nimport _ from \"lodash\"\nimport qs from 'query-string';\n\nimport appData from \"./app\"\nimport AdminRoutes from \"./AdminRoutes\"\n\nconst Admin = (props) => {\n    const { pathname } = props.location\n    const sq = props.location.search && qs.parse(props.location.search) || {}\n\n    const dispatch = useDispatch()\n\n    useEffect(() => {\n        dispatch(getApp(appData))\n    }, [])\n\n    const app = useSelector(state => state.app)\n    const menuByUrl = app && app.menuByUrl\n\n\n    useEffect(() => {\n        menuByUrl && dispatch(getParents({menuByUrl, pathname: pathname}))\n    }, [menuByUrl, pathname])\n\n    // date + view\n\n    let date = sq.date\n    let view = sq.view\n\n    if (!view) {\n        view = \"week\"\n    }\n\n    // select menu or calendar\n\n    const _onSelect = ({url, date}) => {\n\n        if (!url && date) {\n            sq.date = date\n            props.history.replace(pathname + \"?\" + qs.stringify(sq))\n        }\n\n\n        url && props.history.push(url)\n    }\n\n    // search\n\n    const [q, setQ] = useState(sq && sq.q)\n\n    useEffect(() => {\n        if (q) {\n            sq.q = q.replace(' ', '+')\n        } else {\n            delete sq.q\n        }\n\n        let query = qs.stringify(sq)\n\n        const pathname = props.location.pathname + \"?\" + query;\n        const hash = props.location.hash;\n\n        const url = hash && pathname + hash || pathname\n        \n        if (props.history) {\n            props.history.replace(url)\n        }\n    }, [q])\n\n    const _onSearchQuery = _.debounce((q, event) => {\n        setQ(q)\n    }, 500)\n\n    const _onSearchReset = () => {\n        if (q) {\n            setQ('')\n        } else {\n            dispatch(toggleSearch())\n        }\n    }\n\n    // search\n\n    const search = {\n        ...app.search,\n//        expanded: q && q.length && true,\n        q: q,\n        onChange: (q, event) => _onSearchQuery(q),\n        onReset: (q, event) => _onSearchReset(),\n        onToggle: () => dispatch(toggleSearch())\n    }\n    \n\n    return (\n        <AppLayout\n            app={app}\n            theme={app && app.theme}\n            header={app && app.header}\n\n            search={search}\n\n            sidebar={app && app.sidebar}\n\n            primaryAction={app.primaryAction}\n\n            menu={app && app.menu}\n            menuByUrl={app && app.menuByUrl}\n            currentUrl={pathname}\n            \n            parents={app && app.parents}\n\n            onSelect={_onSelect}\n            >\n                <AdminRoutes {...props} />\n        </AppLayout>\n    )\n}\n\nexport default Admin"]},"metadata":{},"sourceType":"module"}