{"ast":null,"code":"\"use strict\";\n\nexports.__esModule = true;\nexports.default = exports.getUiButtons = exports.getObjectButtons = exports.getArrayButtons = exports.getButton = exports.getDialogButton = exports.getUploadButton = void 0;\n\nvar _ = require(\"./\");\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nvar getUploadButton = function getUploadButton(_ref) {\n  var schema = _ref.schema,\n      button = _ref.button,\n      onUpload = _ref.onUpload;\n  var itemSchema, multiple;\n\n  if (schema.type === \"array\") {\n    multiple = true;\n    itemSchema = schema.items;\n  } else {\n    multiple = false;\n    itemSchema = schema;\n  }\n\n  if (!itemSchema || !itemSchema.properties) {\n    return {\n      title: \"failed\"\n    };\n  }\n\n  var mediaType;\n\n  if (itemSchema.properties.media && itemSchema.properties.media.properties && itemSchema.properties.media.properties.mediaType && itemSchema.properties.media.properties.mediaType.default) {\n    mediaType = itemSchema.properties.media.properties.mediaType.default;\n  }\n\n  var accept = button.accept || undefined;\n\n  if (!accept && mediaType) {\n    if (mediaType === \"image\") {\n      accept = \"image/*\";\n    }\n\n    if (mediaType === \"video\") {\n      accept = \"video/*\";\n    }\n\n    if (mediaType === \"audio\") {\n      accept = \"audio/*\";\n    }\n  }\n\n  if (!onUpload) {\n    return _extends({}, button, {\n      disabled: true\n    });\n  }\n\n  return _extends({}, button, {\n    type: \"upload\",\n    accept: accept,\n    multiple: multiple,\n    onUpload: onUpload\n  });\n};\n\nexports.getUploadButton = getUploadButton;\n\nvar getDialogButton = function getDialogButton(_ref2) {\n  var schema = _ref2.schema,\n      button = _ref2.button,\n      onDialog = _ref2.onDialog,\n      type = _ref2.type,\n      registry = _ref2.registry,\n      props = _objectWithoutPropertiesLoose(_ref2, [\"schema\", \"button\", \"onDialog\", \"type\", \"registry\"]);\n\n  var itemSchema;\n\n  if (schema.type === \"array\") {\n    itemSchema = schema.items;\n  } else {\n    itemSchema = schema;\n  }\n\n  if (!onDialog) {\n    return _extends({}, button, {\n      disabled: true\n    });\n  }\n\n  return _extends({}, button, {\n    onClick: function onClick(event) {\n      return onDialog(event, button);\n    }\n  });\n};\n\nexports.getDialogButton = getDialogButton;\n\nvar getButton = function getButton(_ref3) {\n  var schema = _ref3.schema,\n      button = _ref3.button,\n      onAdd = _ref3.onAdd,\n      onUpload = _ref3.onUpload,\n      onDialog = _ref3.onDialog,\n      onSave = _ref3.onSave,\n      onRemove = _ref3.onRemove,\n      onDelete = _ref3.onDelete,\n      onRestore = _ref3.onRestore,\n      props = _objectWithoutPropertiesLoose(_ref3, [\"schema\", \"button\", \"onAdd\", \"onUpload\", \"onDialog\", \"onSave\", \"onRemove\", \"onDelete\", \"onRestore\"]);\n\n  if (typeof button === \"string\") {\n    button = {\n      type: button,\n      title: button.charAt(0).toUpperCase() + button.slice(1)\n    };\n  }\n\n  var _button = button,\n      type = _button.type,\n      item = _button.item,\n      onClick = _button.onClick;\n\n  if (onClick) {\n    return button;\n  }\n\n  if (type === \"upload\") {\n    button = getUploadButton(_extends({\n      schema: schema,\n      button: button,\n      onUpload: onUpload\n    }, props));\n  } else if (type === \"save\") {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onSave();\n      }\n    });\n    /*\n     } else if (type === \"remove\") {\n        button = {\n            ...button,\n            onClick: () => onRemove()\n        }\n     */\n  } else if (type === \"delete\") {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onDelete();\n      }\n    });\n  } else if (type === \"restore\") {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onRestore();\n      }\n    });\n  } else if (type && type.startsWith(\"dialog\") || type && type.startsWith(\"sidebar\")) {\n    button = getDialogButton(_extends({\n      schema: schema,\n      button: button,\n      onDialog: onDialog,\n      type: type\n    }, props));\n  } else if (onAdd && item) {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onAdd(item);\n      }\n    });\n  } else if (onAdd) {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onAdd();\n      }\n    });\n  }\n\n  return button;\n};\n\nexports.getButton = getButton;\n\nvar getArrayButtons = function getArrayButtons(_ref4) {\n  var _ref4$buttons = _ref4.buttons,\n      buttons = _ref4$buttons === void 0 ? [] : _ref4$buttons,\n      canAdd = _ref4.canAdd,\n      onAddItem = _ref4.onAddItem,\n      props = _objectWithoutPropertiesLoose(_ref4, [\"buttons\", \"canAdd\", \"onAddItem\"]);\n\n  if (!canAdd) {\n    return false;\n  }\n\n  var uiButtons = [];\n  var onAdd = canAdd && onAddItem;\n\n  if (buttons && buttons.length) {\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  } else if (onAdd) {\n    buttons = [\"add\"];\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  }\n\n  return uiButtons;\n};\n\nexports.getArrayButtons = getArrayButtons;\n\nvar getObjectButtons = function getObjectButtons(_ref5) {\n  var _ref5$buttons = _ref5.buttons,\n      buttons = _ref5$buttons === void 0 ? [] : _ref5$buttons,\n      onChange = _ref5.onChange,\n      props = _objectWithoutPropertiesLoose(_ref5, [\"buttons\", \"onChange\"]);\n\n  var uiButtons = [];\n  var onAdd = onChange;\n\n  if (buttons && buttons.length) {\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  } else if (props.editable) {\n    buttons = [\"save\"];\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  }\n\n  return uiButtons;\n};\n\nexports.getObjectButtons = getObjectButtons;\n\nvar getUiButtons = function getUiButtons(_ref6) {\n  var _ref6$schema = _ref6.schema,\n      schema = _ref6$schema === void 0 ? {} : _ref6$schema,\n      props = _objectWithoutPropertiesLoose(_ref6, [\"schema\"]);\n\n  var id = props.id,\n      uiSchema = props.uiSchema,\n      formContext = props.formContext;\n  var currentId = formContext && formContext.currentId;\n\n  var _getUiOptions = (0, _.getUiOptions)(uiSchema),\n      buttons = _getUiOptions.buttons,\n      editable = _getUiOptions.editable,\n      nav = _getUiOptions.nav; // dont show button if we're editing a child, unless there is navigation involved\n\n\n  if (!nav && currentId && id && currentId !== id && currentId.includes(id)) {\n    return false;\n  }\n\n  if (schema.type === \"array\") {\n    return getArrayButtons(_extends({\n      schema: schema,\n      buttons: buttons\n    }, props));\n  }\n\n  if (schema.type === \"object\") {\n    return getObjectButtons(_extends({\n      schema: schema,\n      buttons: buttons,\n      editable: editable\n    }, props));\n  }\n};\n\nexports.getUiButtons = getUiButtons;\nvar _default = getUiButtons;\nexports.default = _default;","map":{"version":3,"sources":["/Users/inge/Sites/kit-kulturpunkt/node_modules/@kit-ui/schema/lib/utils/getUiButtons.js"],"names":["exports","__esModule","default","getUiButtons","getObjectButtons","getArrayButtons","getButton","getDialogButton","getUploadButton","_","require","_objectWithoutPropertiesLoose","source","excluded","target","sourceKeys","Object","keys","key","i","length","indexOf","_extends","assign","arguments","prototype","hasOwnProperty","call","apply","_ref","schema","button","onUpload","itemSchema","multiple","type","items","properties","title","mediaType","media","accept","undefined","disabled","_ref2","onDialog","registry","props","onClick","event","_ref3","onAdd","onSave","onRemove","onDelete","onRestore","charAt","toUpperCase","slice","_button","item","startsWith","_ref4","_ref4$buttons","buttons","canAdd","onAddItem","uiButtons","map","_ref5","_ref5$buttons","onChange","editable","_ref6","_ref6$schema","id","uiSchema","formContext","currentId","_getUiOptions","getUiOptions","nav","includes","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\nexports.default = exports.getUiButtons = exports.getObjectButtons = exports.getArrayButtons = exports.getButton = exports.getDialogButton = exports.getUploadButton = void 0;\n\nvar _ = require(\"./\");\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nvar getUploadButton = function getUploadButton(_ref) {\n  var schema = _ref.schema,\n      button = _ref.button,\n      onUpload = _ref.onUpload;\n  var itemSchema, multiple;\n\n  if (schema.type === \"array\") {\n    multiple = true;\n    itemSchema = schema.items;\n  } else {\n    multiple = false;\n    itemSchema = schema;\n  }\n\n  if (!itemSchema || !itemSchema.properties) {\n    return {\n      title: \"failed\"\n    };\n  }\n\n  var mediaType;\n\n  if (itemSchema.properties.media && itemSchema.properties.media.properties && itemSchema.properties.media.properties.mediaType && itemSchema.properties.media.properties.mediaType.default) {\n    mediaType = itemSchema.properties.media.properties.mediaType.default;\n  }\n\n  var accept = button.accept || undefined;\n\n  if (!accept && mediaType) {\n    if (mediaType === \"image\") {\n      accept = \"image/*\";\n    }\n\n    if (mediaType === \"video\") {\n      accept = \"video/*\";\n    }\n\n    if (mediaType === \"audio\") {\n      accept = \"audio/*\";\n    }\n  }\n\n  if (!onUpload) {\n    return _extends({}, button, {\n      disabled: true\n    });\n  }\n\n  return _extends({}, button, {\n    type: \"upload\",\n    accept: accept,\n    multiple: multiple,\n    onUpload: onUpload\n  });\n};\n\nexports.getUploadButton = getUploadButton;\n\nvar getDialogButton = function getDialogButton(_ref2) {\n  var schema = _ref2.schema,\n      button = _ref2.button,\n      onDialog = _ref2.onDialog,\n      type = _ref2.type,\n      registry = _ref2.registry,\n      props = _objectWithoutPropertiesLoose(_ref2, [\"schema\", \"button\", \"onDialog\", \"type\", \"registry\"]);\n\n  var itemSchema;\n\n  if (schema.type === \"array\") {\n    itemSchema = schema.items;\n  } else {\n    itemSchema = schema;\n  }\n\n  if (!onDialog) {\n    return _extends({}, button, {\n      disabled: true\n    });\n  }\n\n  return _extends({}, button, {\n    onClick: function onClick(event) {\n      return onDialog(event, button);\n    }\n  });\n};\n\nexports.getDialogButton = getDialogButton;\n\nvar getButton = function getButton(_ref3) {\n  var schema = _ref3.schema,\n      button = _ref3.button,\n      onAdd = _ref3.onAdd,\n      onUpload = _ref3.onUpload,\n      onDialog = _ref3.onDialog,\n      onSave = _ref3.onSave,\n      onRemove = _ref3.onRemove,\n      onDelete = _ref3.onDelete,\n      onRestore = _ref3.onRestore,\n      props = _objectWithoutPropertiesLoose(_ref3, [\"schema\", \"button\", \"onAdd\", \"onUpload\", \"onDialog\", \"onSave\", \"onRemove\", \"onDelete\", \"onRestore\"]);\n\n  if (typeof button === \"string\") {\n    button = {\n      type: button,\n      title: button.charAt(0).toUpperCase() + button.slice(1)\n    };\n  }\n\n  var _button = button,\n      type = _button.type,\n      item = _button.item,\n      onClick = _button.onClick;\n\n  if (onClick) {\n    return button;\n  }\n\n  if (type === \"upload\") {\n    button = getUploadButton(_extends({\n      schema: schema,\n      button: button,\n      onUpload: onUpload\n    }, props));\n  } else if (type === \"save\") {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onSave();\n      }\n    });\n    /*\n     } else if (type === \"remove\") {\n        button = {\n            ...button,\n            onClick: () => onRemove()\n        }\n     */\n  } else if (type === \"delete\") {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onDelete();\n      }\n    });\n  } else if (type === \"restore\") {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onRestore();\n      }\n    });\n  } else if (type && type.startsWith(\"dialog\") || type && type.startsWith(\"sidebar\")) {\n    button = getDialogButton(_extends({\n      schema: schema,\n      button: button,\n      onDialog: onDialog,\n      type: type\n    }, props));\n  } else if (onAdd && item) {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onAdd(item);\n      }\n    });\n  } else if (onAdd) {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onAdd();\n      }\n    });\n  }\n\n  return button;\n};\n\nexports.getButton = getButton;\n\nvar getArrayButtons = function getArrayButtons(_ref4) {\n  var _ref4$buttons = _ref4.buttons,\n      buttons = _ref4$buttons === void 0 ? [] : _ref4$buttons,\n      canAdd = _ref4.canAdd,\n      onAddItem = _ref4.onAddItem,\n      props = _objectWithoutPropertiesLoose(_ref4, [\"buttons\", \"canAdd\", \"onAddItem\"]);\n\n  if (!canAdd) {\n    return false;\n  }\n\n  var uiButtons = [];\n  var onAdd = canAdd && onAddItem;\n\n  if (buttons && buttons.length) {\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  } else if (onAdd) {\n    buttons = [\"add\"];\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  }\n\n  return uiButtons;\n};\n\nexports.getArrayButtons = getArrayButtons;\n\nvar getObjectButtons = function getObjectButtons(_ref5) {\n  var _ref5$buttons = _ref5.buttons,\n      buttons = _ref5$buttons === void 0 ? [] : _ref5$buttons,\n      onChange = _ref5.onChange,\n      props = _objectWithoutPropertiesLoose(_ref5, [\"buttons\", \"onChange\"]);\n\n  var uiButtons = [];\n  var onAdd = onChange;\n\n  if (buttons && buttons.length) {\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  } else if (props.editable) {\n    buttons = [\"save\"];\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  }\n\n  return uiButtons;\n};\n\nexports.getObjectButtons = getObjectButtons;\n\nvar getUiButtons = function getUiButtons(_ref6) {\n  var _ref6$schema = _ref6.schema,\n      schema = _ref6$schema === void 0 ? {} : _ref6$schema,\n      props = _objectWithoutPropertiesLoose(_ref6, [\"schema\"]);\n\n  var id = props.id,\n      uiSchema = props.uiSchema,\n      formContext = props.formContext;\n  var currentId = formContext && formContext.currentId;\n\n  var _getUiOptions = (0, _.getUiOptions)(uiSchema),\n      buttons = _getUiOptions.buttons,\n      editable = _getUiOptions.editable,\n      nav = _getUiOptions.nav; // dont show button if we're editing a child, unless there is navigation involved\n\n\n  if (!nav && currentId && id && currentId !== id && currentId.includes(id)) {\n    return false;\n  }\n\n  if (schema.type === \"array\") {\n    return getArrayButtons(_extends({\n      schema: schema,\n      buttons: buttons\n    }, props));\n  }\n\n  if (schema.type === \"object\") {\n    return getObjectButtons(_extends({\n      schema: schema,\n      buttons: buttons,\n      editable: editable\n    }, props));\n  }\n};\n\nexports.getUiButtons = getUiButtons;\nvar _default = getUiButtons;\nexports.default = _default;"]},"metadata":{},"sourceType":"script"}