{"ast":null,"code":"import { API } from \"../settings\";\nimport { createSlice } from '@reduxjs/toolkit';\nimport { requestModel, receiveModel } from \"../modelsById\";\nimport schema from \"../../schemas/article/section/schema\";\nconst editorSlide = createSlice({\n  name: 'editor',\n  initialState: {\n    isLoading: false,\n    isSaving: false,\n    currentId: undefined,\n    formData: {},\n    dialog: {}\n  },\n  reducers: {\n    requestEdit(state, action) {\n      const {\n        uniqueId\n      } = action.payload;\n      return {\n        isLoading: true,\n        formData: {\n          uniqueId: uniqueId\n        }\n      };\n    },\n\n    receiveEdit(state, action) {\n      const {\n        uniqueId,\n        ...formData\n      } = action.payload;\n\n      if (uniqueId) {\n        return { ...state,\n          isLoading: false,\n          formData: { ...formData,\n            uniqueId: uniqueId\n          }\n        };\n      } else {\n        return { ...state,\n          isLoading: false,\n          formData: formData\n        };\n      }\n    },\n\n    requestSave(state, action) {\n      return { ...state,\n        isSaving: true\n      };\n    },\n\n    receiveSave(state, action) {\n      const {\n        uniqueId,\n        ...formData\n      } = action.payload;\n      return {\n        isSaving: false,\n        formData: { ...formData,\n          uniqueId: uniqueId\n        }\n      };\n    },\n\n    receiveCurrentId(state, action) {\n      const {\n        currentId\n      } = action.payload;\n      return { ...state,\n        currentId: currentId\n      };\n    },\n\n    requestDialog(state, action) {\n      return { ...state,\n        dialog: {}\n      };\n    },\n\n    receiveDialog(state, action) {\n      const {\n        id,\n        schema,\n        uiSchema,\n        formData,\n        onChange\n      } = action.payload;\n      return { ...state,\n        dialog: {\n          expanded: true,\n          id: id,\n          schema: schema,\n          //                    uiSchema: uiSchema,\n          formData: formData,\n          onChange: onChange\n        }\n      };\n    }\n\n  }\n});\n/** Edit model from uniqueId */\n\nexport const editModel = ({\n  modelName = \"documents\",\n  uniqueId,\n  ...formData\n}) => dispatch => {\n  const url = API + '/admin/api/' + modelName + '/' + uniqueId;\n\n  if (uniqueId) {\n    dispatch(requestEdit({\n      uniqueId\n    }));\n    fetch(url, {\n      method: \"GET\",\n      headers: {\n        \"Accept\": \"application/json\",\n        \"Content-Type\": \"application/json; charset=utf-8\"\n      }\n    }).then(response => response.json(), error => console.log('An error occurred.', error)).then(formData => {\n      dispatch(receiveEdit(formData));\n      dispatch(receiveModel(formData));\n    });\n  } else if (formData) {\n    dispatch(receiveEdit(formData));\n  }\n};\n/** Save model from formData  */\n\nexport const saveModel = ({\n  modelName = \"documents\",\n  ...formData\n}) => dispatch => {\n  const url = API + '/admin/api/' + modelName;\n  dispatch(requestSave());\n  fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Accept\": \"application/json\",\n      \"Content-Type\": \"application/json; charset=utf-8\"\n    },\n    body: JSON.stringify(formData)\n  }).then(response => response.json(), error => console.log('An error occurred.', error)).then(formData => {\n    dispatch(receiveSave(formData));\n    dispatch(receiveModel(formData));\n  });\n};\nexport const {\n  requestEdit,\n  receiveEdit,\n  requestSave,\n  receiveSave,\n  receiveCurrentId,\n  requestDialog,\n  receiveDialog\n} = editorSlide.actions;\nexport default editorSlide.reducer;","map":{"version":3,"sources":["/Users/inge/Sites/kit-kulturpunkt/src/redux/editor/editorSlice.js"],"names":["API","createSlice","requestModel","receiveModel","schema","editorSlide","name","initialState","isLoading","isSaving","currentId","undefined","formData","dialog","reducers","requestEdit","state","action","uniqueId","payload","receiveEdit","requestSave","receiveSave","receiveCurrentId","requestDialog","receiveDialog","id","uiSchema","onChange","expanded","editModel","modelName","dispatch","url","fetch","method","headers","then","response","json","error","console","log","saveModel","body","JSON","stringify","actions","reducer"],"mappings":"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","sourcesContent":["import { API } from \"../settings\"\nimport { createSlice } from '@reduxjs/toolkit'\n\nimport { requestModel, receiveModel } from \"../modelsById\"\nimport schema from \"../../schemas/article/section/schema\"\n\nconst editorSlide = createSlice({\n    name: 'editor',\n    initialState: {\n        isLoading: false,\n        isSaving: false,\n        currentId: undefined,\n        formData: {},\n        dialog: {}\n    }, \n    reducers: {\n        requestEdit(state, action) {\n            const { uniqueId } = action.payload\n\n            return {\n                isLoading: true,\n                formData: {\n                    uniqueId: uniqueId\n                }\n            }\n\n        },\n        receiveEdit(state, action) {\n            const { uniqueId, ...formData } = action.payload\n\n            if (uniqueId) {\n                return {\n                    ...state,\n                    isLoading: false,\n                    formData: {\n                        ...formData,\n                        uniqueId: uniqueId\n                    }\n                }\n            } else {\n                return {\n                    ...state,\n                    isLoading: false,\n                    formData: formData\n                }\n            }\n\n        },\n        requestSave(state, action) {\n           return {\n                ...state,\n                isSaving: true,\n            }\n\n        },\n        receiveSave(state, action) {\n            const { uniqueId, ...formData } = action.payload\n\n            return {\n                isSaving: false,\n                formData: {\n                    ...formData,\n                    uniqueId: uniqueId\n                }\n            }\n        },\n        receiveCurrentId(state, action) {\n            const { currentId } = action.payload\n            return {\n                ...state,\n                currentId: currentId,\n            }\n        },\n        requestDialog(state, action) {\n            return {\n                ...state,\n                dialog: {},\n            }\n        },\n        receiveDialog(state, action) {\n            const { id, schema, uiSchema, formData, onChange } = action.payload\n            return {\n                ...state,\n                dialog: {\n                    expanded: true,\n                    id: id,\n                    schema: schema,\n//                    uiSchema: uiSchema,\n                    formData: formData,\n                    onChange: onChange\n                },\n            }\n        }        \n    }\n})\n\n/** Edit model from uniqueId */\n\nexport const editModel = ({modelName = \"documents\", uniqueId, ...formData}) => dispatch => {\n\n    const url = API + '/admin/api/' + modelName + '/' + uniqueId;\n\n    if (uniqueId) {\n        dispatch(requestEdit({uniqueId}))\n        \n        fetch(url, {\n            method: \"GET\",\n            headers: {\n                \"Accept\": \"application/json\",\n                \"Content-Type\": \"application/json; charset=utf-8\",\n            }})\n            .then(\n                response => response.json(),\n                error => console.log('An error occurred.', error)\n            )\n            .then(formData => {\n                dispatch(receiveEdit(formData))\n                dispatch(receiveModel(formData))\n            })\n\n    } else if (formData) {\n        dispatch(receiveEdit(formData))\n    }\n\n}\n\n/** Save model from formData  */\n\nexport const saveModel = ({modelName = \"documents\", ...formData}) => dispatch => {\n    const url = API + '/admin/api/' + modelName;\n\n    dispatch(requestSave())\n\n    fetch(url, {\n        method: \"POST\",\n        headers: {\n            \"Accept\": \"application/json\",\n            \"Content-Type\": \"application/json; charset=utf-8\",\n        },\n        body: JSON.stringify(formData)\n    })\n    .then(\n        response => response.json(),\n        error => console.log('An error occurred.', error)\n    )\n    .then(formData => {\n        dispatch(receiveSave(formData))\n        dispatch(receiveModel(formData))\n    })\n\n}\n\nexport const { requestEdit, receiveEdit, requestSave, receiveSave, receiveCurrentId, requestDialog, receiveDialog } = editorSlide.actions\nexport default editorSlide.reducer"]},"metadata":{},"sourceType":"module"}