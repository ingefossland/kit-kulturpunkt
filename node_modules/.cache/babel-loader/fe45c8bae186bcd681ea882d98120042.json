{"ast":null,"code":"\"use strict\";\n\nexports.__esModule = true;\nexports.getPreviewLocalizedString = getPreviewLocalizedString;\nexports.getPreviewFilters = getPreviewFilters;\nexports.getPreviewData = getPreviewData;\nexports.default = exports.getUiPreview = void 0;\n\nvar _ = require(\"./\");\n\nfunction getPreviewLocalizedString(localizedString, props) {\n  var formContext = props.formContext;\n  var currentLocale = formContext && formContext.currentLocale || formContext && formContext.languages && formContext.languages[0];\n\n  if (!currentLocale) {\n    return;\n  }\n\n  var localeId = \"locale:\" + currentLocale;\n  return localizedString && localizedString[localeId];\n}\n\nfunction getPreviewFilters(value, props) {\n  var schema = props.schema,\n      formData = props.formData,\n      index = props.index;\n\n  if (schema && schema.type === \"array\" && formData && formData.length) {\n    value = value && value.replace(\"{count}\", formData.length);\n  } else if (index) {\n    value = value && value.replace(\"{count}\", index + 1);\n    value = value && value.replace(\"{index}\", index);\n  }\n\n  return value;\n}\n\nfunction getPreviewData(preview, props) {\n  var schema = props.schema,\n      formData = props.formData;\n  var select = preview.select,\n      prepare = preview.prepare,\n      single = preview.single,\n      plural = preview.plural,\n      empty = preview.empty;\n  var selection;\n\n  if (prepare && typeof prepare === \"function\") {\n    selection = prepare(props);\n  } else if (prepare) {\n    selection = prepare;\n  } else {\n    selection = formData;\n  }\n\n  var data = {};\n\n  if (select) {\n    Object.keys(select).map(function (name) {\n      var key = select[name] || name;\n      var value = null;\n\n      if (select.hasOwnProperty(key) && selection && selection[key]) {\n        value = selection[key];\n      }\n\n      if (typeof value === \"object\" && value !== null && schema && schema.type === \"array\") {\n        if (formData && formData.length && formData.length > 1 && value.plural) {\n          value = value.plural;\n        } else if (formData && formData.length && formData.length === 1 && value.single) {\n          value = value.single;\n        } else if (value.empty) {\n          value = value.empty;\n        }\n      }\n      /*\n       if (typeof value === \"object\" && value !== null) {\n          value = getPreviewLocalizedString(value, props)\n      }\n       */\n\n\n      if (value && typeof value === \"string\") {\n        value = getPreviewFilters(value, props);\n      }\n\n      if (name === \"metadata\" && selection[key]) {\n        data[name] = selection[key];\n      }\n\n      if (value) {\n        data[name] = value;\n      }\n    });\n  }\n\n  return data;\n}\n\nvar getUiPreview = function getUiPreview(_ref) {\n  var schema = _ref.schema,\n      _ref$uiSchema = _ref.uiSchema,\n      uiSchema = _ref$uiSchema === void 0 ? {} : _ref$uiSchema,\n      formData = _ref.formData,\n      formContext = _ref.formContext,\n      index = _ref.index;\n  var uiOptions = (0, _.getUiOptions)(uiSchema);\n  var previewData = {\n    schema: schema,\n    formData: formData,\n    formContext: formContext,\n    index: index\n  };\n\n  if (uiOptions.preview) {\n    return getPreviewData(uiOptions.preview, previewData);\n  }\n};\n\nexports.getUiPreview = getUiPreview;\nvar _default = getUiPreview;\nexports.default = _default;","map":{"version":3,"sources":["/Users/inge/Sites/kit-kulturpunkt/node_modules/@kit-ui/schema/lib/utils/getUiPreview.js"],"names":["exports","__esModule","getPreviewLocalizedString","getPreviewFilters","getPreviewData","default","getUiPreview","_","require","localizedString","props","formContext","currentLocale","languages","localeId","value","schema","formData","index","type","length","replace","preview","select","prepare","single","plural","empty","selection","data","Object","keys","map","name","key","hasOwnProperty","_ref","_ref$uiSchema","uiSchema","uiOptions","getUiOptions","previewData","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\nexports.getPreviewLocalizedString = getPreviewLocalizedString;\nexports.getPreviewFilters = getPreviewFilters;\nexports.getPreviewData = getPreviewData;\nexports.default = exports.getUiPreview = void 0;\n\nvar _ = require(\"./\");\n\nfunction getPreviewLocalizedString(localizedString, props) {\n  var formContext = props.formContext;\n  var currentLocale = formContext && formContext.currentLocale || formContext && formContext.languages && formContext.languages[0];\n\n  if (!currentLocale) {\n    return;\n  }\n\n  var localeId = \"locale:\" + currentLocale;\n  return localizedString && localizedString[localeId];\n}\n\nfunction getPreviewFilters(value, props) {\n  var schema = props.schema,\n      formData = props.formData,\n      index = props.index;\n\n  if (schema && schema.type === \"array\" && formData && formData.length) {\n    value = value && value.replace(\"{count}\", formData.length);\n  } else if (index) {\n    value = value && value.replace(\"{count}\", index + 1);\n    value = value && value.replace(\"{index}\", index);\n  }\n\n  return value;\n}\n\nfunction getPreviewData(preview, props) {\n  var schema = props.schema,\n      formData = props.formData;\n  var select = preview.select,\n      prepare = preview.prepare,\n      single = preview.single,\n      plural = preview.plural,\n      empty = preview.empty;\n  var selection;\n\n  if (prepare && typeof prepare === \"function\") {\n    selection = prepare(props);\n  } else if (prepare) {\n    selection = prepare;\n  } else {\n    selection = formData;\n  }\n\n  var data = {};\n\n  if (select) {\n    Object.keys(select).map(function (name) {\n      var key = select[name] || name;\n      var value = null;\n\n      if (select.hasOwnProperty(key) && selection && selection[key]) {\n        value = selection[key];\n      }\n\n      if (typeof value === \"object\" && value !== null && schema && schema.type === \"array\") {\n        if (formData && formData.length && formData.length > 1 && value.plural) {\n          value = value.plural;\n        } else if (formData && formData.length && formData.length === 1 && value.single) {\n          value = value.single;\n        } else if (value.empty) {\n          value = value.empty;\n        }\n      }\n      /*\n       if (typeof value === \"object\" && value !== null) {\n          value = getPreviewLocalizedString(value, props)\n      }\n       */\n\n\n      if (value && typeof value === \"string\") {\n        value = getPreviewFilters(value, props);\n      }\n\n      if (name === \"metadata\" && selection[key]) {\n        data[name] = selection[key];\n      }\n\n      if (value) {\n        data[name] = value;\n      }\n    });\n  }\n\n  return data;\n}\n\nvar getUiPreview = function getUiPreview(_ref) {\n  var schema = _ref.schema,\n      _ref$uiSchema = _ref.uiSchema,\n      uiSchema = _ref$uiSchema === void 0 ? {} : _ref$uiSchema,\n      formData = _ref.formData,\n      formContext = _ref.formContext,\n      index = _ref.index;\n  var uiOptions = (0, _.getUiOptions)(uiSchema);\n  var previewData = {\n    schema: schema,\n    formData: formData,\n    formContext: formContext,\n    index: index\n  };\n\n  if (uiOptions.preview) {\n    return getPreviewData(uiOptions.preview, previewData);\n  }\n};\n\nexports.getUiPreview = getUiPreview;\nvar _default = getUiPreview;\nexports.default = _default;"]},"metadata":{},"sourceType":"script"}