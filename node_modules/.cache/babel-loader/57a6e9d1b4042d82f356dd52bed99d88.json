{"ast":null,"code":"function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nimport { getUiOptions } from './';\nexport var getUploadButton = function getUploadButton(_ref) {\n  var schema = _ref.schema,\n      button = _ref.button,\n      onUpload = _ref.onUpload;\n  var itemSchema, multiple;\n\n  if (schema.type === \"array\") {\n    multiple = true;\n    itemSchema = schema.items;\n  } else {\n    multiple = false;\n    itemSchema = schema;\n  }\n\n  if (!itemSchema || !itemSchema.properties) {\n    return {\n      title: \"failed\"\n    };\n  }\n\n  var mediaType;\n\n  if (itemSchema.properties.media && itemSchema.properties.media.properties && itemSchema.properties.media.properties.mediaType && itemSchema.properties.media.properties.mediaType.default) {\n    mediaType = itemSchema.properties.media.properties.mediaType.default;\n  }\n\n  var accept = button.accept || undefined;\n\n  if (!accept && mediaType) {\n    if (mediaType === \"image\") {\n      accept = \"image/*\";\n    }\n\n    if (mediaType === \"video\") {\n      accept = \"video/*\";\n    }\n\n    if (mediaType === \"audio\") {\n      accept = \"audio/*\";\n    }\n  }\n\n  if (!onUpload) {\n    return _extends({}, button, {\n      disabled: true\n    });\n  }\n\n  return _extends({}, button, {\n    type: \"upload\",\n    accept: accept,\n    multiple: multiple,\n    onUpload: onUpload\n  });\n};\nexport var getDialogButton = function getDialogButton(_ref2) {\n  var schema = _ref2.schema,\n      button = _ref2.button,\n      onDialog = _ref2.onDialog,\n      type = _ref2.type,\n      registry = _ref2.registry,\n      props = _objectWithoutPropertiesLoose(_ref2, [\"schema\", \"button\", \"onDialog\", \"type\", \"registry\"]);\n\n  var itemSchema;\n\n  if (schema.type === \"array\") {\n    itemSchema = schema.items;\n  } else {\n    itemSchema = schema;\n  }\n\n  if (!onDialog) {\n    return _extends({}, button, {\n      disabled: true\n    });\n  }\n\n  return _extends({}, button, {\n    onClick: function onClick(event) {\n      return onDialog(event, button);\n    }\n  });\n};\nexport var getButton = function getButton(_ref3) {\n  var schema = _ref3.schema,\n      button = _ref3.button,\n      onAdd = _ref3.onAdd,\n      onUpload = _ref3.onUpload,\n      onDialog = _ref3.onDialog,\n      onSave = _ref3.onSave,\n      onRemove = _ref3.onRemove,\n      onDelete = _ref3.onDelete,\n      onRestore = _ref3.onRestore,\n      props = _objectWithoutPropertiesLoose(_ref3, [\"schema\", \"button\", \"onAdd\", \"onUpload\", \"onDialog\", \"onSave\", \"onRemove\", \"onDelete\", \"onRestore\"]);\n\n  if (typeof button === \"string\") {\n    button = {\n      type: button,\n      title: button.charAt(0).toUpperCase() + button.slice(1)\n    };\n  }\n\n  var _button = button,\n      type = _button.type,\n      item = _button.item,\n      onClick = _button.onClick;\n\n  if (onClick) {\n    return button;\n  }\n\n  if (type === \"upload\") {\n    button = getUploadButton(_extends({\n      schema: schema,\n      button: button,\n      onUpload: onUpload\n    }, props));\n  } else if (type === \"save\") {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onSave();\n      }\n    });\n    /*\n     } else if (type === \"remove\") {\n        button = {\n            ...button,\n            onClick: () => onRemove()\n        }\n     */\n  } else if (type === \"delete\") {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onDelete();\n      }\n    });\n  } else if (type === \"restore\") {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onRestore();\n      }\n    });\n  } else if (type && type.startsWith(\"dialog\") || type && type.startsWith(\"sidebar\")) {\n    button = getDialogButton(_extends({\n      schema: schema,\n      button: button,\n      onDialog: onDialog,\n      type: type\n    }, props));\n  } else if (onAdd && item) {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onAdd(item);\n      }\n    });\n  } else if (onAdd) {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onAdd();\n      }\n    });\n  }\n\n  return button;\n};\nexport var getArrayButtons = function getArrayButtons(_ref4) {\n  var _ref4$buttons = _ref4.buttons,\n      buttons = _ref4$buttons === void 0 ? [] : _ref4$buttons,\n      canAdd = _ref4.canAdd,\n      onAddItem = _ref4.onAddItem,\n      props = _objectWithoutPropertiesLoose(_ref4, [\"buttons\", \"canAdd\", \"onAddItem\"]);\n\n  if (!canAdd) {\n    return false;\n  }\n\n  var uiButtons = [];\n  var onAdd = canAdd && onAddItem;\n\n  if (buttons && buttons.length) {\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  } else if (onAdd) {\n    buttons = [\"add\"];\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  }\n\n  return uiButtons;\n};\nexport var getObjectButtons = function getObjectButtons(_ref5) {\n  var _ref5$buttons = _ref5.buttons,\n      buttons = _ref5$buttons === void 0 ? [] : _ref5$buttons,\n      onChange = _ref5.onChange,\n      props = _objectWithoutPropertiesLoose(_ref5, [\"buttons\", \"onChange\"]);\n\n  var uiButtons = [];\n  var onAdd = onChange;\n\n  if (buttons && buttons.length) {\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  } else if (props.editable) {\n    buttons = [\"save\"];\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  }\n\n  return uiButtons;\n};\nexport var getUiButtons = function getUiButtons(_ref6) {\n  var _ref6$schema = _ref6.schema,\n      schema = _ref6$schema === void 0 ? {} : _ref6$schema,\n      props = _objectWithoutPropertiesLoose(_ref6, [\"schema\"]);\n\n  var id = props.id,\n      uiSchema = props.uiSchema,\n      formContext = props.formContext;\n  var currentId = formContext && formContext.currentId;\n\n  var _getUiOptions = getUiOptions(uiSchema),\n      buttons = _getUiOptions.buttons,\n      editable = _getUiOptions.editable,\n      nav = _getUiOptions.nav; // dont show button if we're editing a child, unless there is navigation involved\n\n\n  if (!nav && currentId && id && currentId !== id && currentId.includes(id)) {\n    return false;\n  }\n\n  if (schema.type === \"array\") {\n    return getArrayButtons(_extends({\n      schema: schema,\n      buttons: buttons\n    }, props));\n  }\n\n  if (schema.type === \"object\") {\n    return getObjectButtons(_extends({\n      schema: schema,\n      buttons: buttons,\n      editable: editable\n    }, props));\n  }\n};\nexport default getUiButtons;","map":{"version":3,"sources":["/Users/inge/Sites/kit-kulturpunkt/node_modules/@kit-ui/schema/es/utils/getUiButtons.js"],"names":["_objectWithoutPropertiesLoose","source","excluded","target","sourceKeys","Object","keys","key","i","length","indexOf","_extends","assign","arguments","prototype","hasOwnProperty","call","apply","getUiOptions","getUploadButton","_ref","schema","button","onUpload","itemSchema","multiple","type","items","properties","title","mediaType","media","default","accept","undefined","disabled","getDialogButton","_ref2","onDialog","registry","props","onClick","event","getButton","_ref3","onAdd","onSave","onRemove","onDelete","onRestore","charAt","toUpperCase","slice","_button","item","startsWith","getArrayButtons","_ref4","_ref4$buttons","buttons","canAdd","onAddItem","uiButtons","map","getObjectButtons","_ref5","_ref5$buttons","onChange","editable","getUiButtons","_ref6","_ref6$schema","id","uiSchema","formContext","currentId","_getUiOptions","nav","includes"],"mappings":"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","sourcesContent":["function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { getUiOptions } from './';\nexport var getUploadButton = function getUploadButton(_ref) {\n  var schema = _ref.schema,\n      button = _ref.button,\n      onUpload = _ref.onUpload;\n  var itemSchema, multiple;\n\n  if (schema.type === \"array\") {\n    multiple = true;\n    itemSchema = schema.items;\n  } else {\n    multiple = false;\n    itemSchema = schema;\n  }\n\n  if (!itemSchema || !itemSchema.properties) {\n    return {\n      title: \"failed\"\n    };\n  }\n\n  var mediaType;\n\n  if (itemSchema.properties.media && itemSchema.properties.media.properties && itemSchema.properties.media.properties.mediaType && itemSchema.properties.media.properties.mediaType.default) {\n    mediaType = itemSchema.properties.media.properties.mediaType.default;\n  }\n\n  var accept = button.accept || undefined;\n\n  if (!accept && mediaType) {\n    if (mediaType === \"image\") {\n      accept = \"image/*\";\n    }\n\n    if (mediaType === \"video\") {\n      accept = \"video/*\";\n    }\n\n    if (mediaType === \"audio\") {\n      accept = \"audio/*\";\n    }\n  }\n\n  if (!onUpload) {\n    return _extends({}, button, {\n      disabled: true\n    });\n  }\n\n  return _extends({}, button, {\n    type: \"upload\",\n    accept: accept,\n    multiple: multiple,\n    onUpload: onUpload\n  });\n};\nexport var getDialogButton = function getDialogButton(_ref2) {\n  var schema = _ref2.schema,\n      button = _ref2.button,\n      onDialog = _ref2.onDialog,\n      type = _ref2.type,\n      registry = _ref2.registry,\n      props = _objectWithoutPropertiesLoose(_ref2, [\"schema\", \"button\", \"onDialog\", \"type\", \"registry\"]);\n\n  var itemSchema;\n\n  if (schema.type === \"array\") {\n    itemSchema = schema.items;\n  } else {\n    itemSchema = schema;\n  }\n\n  if (!onDialog) {\n    return _extends({}, button, {\n      disabled: true\n    });\n  }\n\n  return _extends({}, button, {\n    onClick: function onClick(event) {\n      return onDialog(event, button);\n    }\n  });\n};\nexport var getButton = function getButton(_ref3) {\n  var schema = _ref3.schema,\n      button = _ref3.button,\n      onAdd = _ref3.onAdd,\n      onUpload = _ref3.onUpload,\n      onDialog = _ref3.onDialog,\n      onSave = _ref3.onSave,\n      onRemove = _ref3.onRemove,\n      onDelete = _ref3.onDelete,\n      onRestore = _ref3.onRestore,\n      props = _objectWithoutPropertiesLoose(_ref3, [\"schema\", \"button\", \"onAdd\", \"onUpload\", \"onDialog\", \"onSave\", \"onRemove\", \"onDelete\", \"onRestore\"]);\n\n  if (typeof button === \"string\") {\n    button = {\n      type: button,\n      title: button.charAt(0).toUpperCase() + button.slice(1)\n    };\n  }\n\n  var _button = button,\n      type = _button.type,\n      item = _button.item,\n      onClick = _button.onClick;\n\n  if (onClick) {\n    return button;\n  }\n\n  if (type === \"upload\") {\n    button = getUploadButton(_extends({\n      schema: schema,\n      button: button,\n      onUpload: onUpload\n    }, props));\n  } else if (type === \"save\") {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onSave();\n      }\n    });\n    /*\n     } else if (type === \"remove\") {\n        button = {\n            ...button,\n            onClick: () => onRemove()\n        }\n     */\n  } else if (type === \"delete\") {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onDelete();\n      }\n    });\n  } else if (type === \"restore\") {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onRestore();\n      }\n    });\n  } else if (type && type.startsWith(\"dialog\") || type && type.startsWith(\"sidebar\")) {\n    button = getDialogButton(_extends({\n      schema: schema,\n      button: button,\n      onDialog: onDialog,\n      type: type\n    }, props));\n  } else if (onAdd && item) {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onAdd(item);\n      }\n    });\n  } else if (onAdd) {\n    button = _extends({}, button, {\n      onClick: function onClick() {\n        return onAdd();\n      }\n    });\n  }\n\n  return button;\n};\nexport var getArrayButtons = function getArrayButtons(_ref4) {\n  var _ref4$buttons = _ref4.buttons,\n      buttons = _ref4$buttons === void 0 ? [] : _ref4$buttons,\n      canAdd = _ref4.canAdd,\n      onAddItem = _ref4.onAddItem,\n      props = _objectWithoutPropertiesLoose(_ref4, [\"buttons\", \"canAdd\", \"onAddItem\"]);\n\n  if (!canAdd) {\n    return false;\n  }\n\n  var uiButtons = [];\n  var onAdd = canAdd && onAddItem;\n\n  if (buttons && buttons.length) {\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  } else if (onAdd) {\n    buttons = [\"add\"];\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  }\n\n  return uiButtons;\n};\nexport var getObjectButtons = function getObjectButtons(_ref5) {\n  var _ref5$buttons = _ref5.buttons,\n      buttons = _ref5$buttons === void 0 ? [] : _ref5$buttons,\n      onChange = _ref5.onChange,\n      props = _objectWithoutPropertiesLoose(_ref5, [\"buttons\", \"onChange\"]);\n\n  var uiButtons = [];\n  var onAdd = onChange;\n\n  if (buttons && buttons.length) {\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  } else if (props.editable) {\n    buttons = [\"save\"];\n    uiButtons = buttons.map(function (button) {\n      return getButton(_extends({\n        button: button,\n        onAdd: onAdd\n      }, props));\n    });\n  }\n\n  return uiButtons;\n};\nexport var getUiButtons = function getUiButtons(_ref6) {\n  var _ref6$schema = _ref6.schema,\n      schema = _ref6$schema === void 0 ? {} : _ref6$schema,\n      props = _objectWithoutPropertiesLoose(_ref6, [\"schema\"]);\n\n  var id = props.id,\n      uiSchema = props.uiSchema,\n      formContext = props.formContext;\n  var currentId = formContext && formContext.currentId;\n\n  var _getUiOptions = getUiOptions(uiSchema),\n      buttons = _getUiOptions.buttons,\n      editable = _getUiOptions.editable,\n      nav = _getUiOptions.nav; // dont show button if we're editing a child, unless there is navigation involved\n\n\n  if (!nav && currentId && id && currentId !== id && currentId.includes(id)) {\n    return false;\n  }\n\n  if (schema.type === \"array\") {\n    return getArrayButtons(_extends({\n      schema: schema,\n      buttons: buttons\n    }, props));\n  }\n\n  if (schema.type === \"object\") {\n    return getObjectButtons(_extends({\n      schema: schema,\n      buttons: buttons,\n      editable: editable\n    }, props));\n  }\n};\nexport default getUiButtons;"]},"metadata":{},"sourceType":"module"}